# 🥝 키위 농장 통합 AI 관리 시스템

**생육 단계별 자동 전환** 키위 농장 AI 시스템입니다.

## 🌟 핵심 기능

### ✅ 완전 자동화
- GitHub Actions가 **매일 자정** 자동 실행
- ECOWITT 센서 데이터 자동 수집
- 적산온도(GDD) 자동 계산
- 생육 단계 자동 감지 및 기록

### 🔄 생육 단계별 자동 전환

```
1~3월  🌱 휴면기/발아기    → 발아/개화 예측
4~5월  🌸 개화기/착과기    → 착과율 예측
6~10월 🥝 과실 비대기      → 과실 크기/무게 예측
11~12월 📦 수확 후 관리     → 연간 리포트
```

### 🤖 단계별 AI 예측

#### 1~3월: 발아/개화 예측
- 적산온도 기반 발아일 예측
- 개화 시기 예측
- 저온 쇼크 감지

#### 4~5월: 착과율 예측
- 개화기 환경 조건 분석
- 착과율 예측
- 수분 최적 시간 추천

#### 6~10월: 과실 성장 예측
- 실측 데이터 기반 AI 학습
- 최종 크기/무게 예측
- 수확 시기 권장

#### 11~12월: 연간 리포트
- 올해 생육 분석
- 작년 대비 비교
- 내년 개선 제안

## 📁 프로젝트 구조

```
kiwi-integrated-system/
├── .github/workflows/
│   └── daily_collection.yml       # 매일 자동 실행
│
├── scripts/
│   └── collect_daily_data.py      # 데이터 수집 스크립트
│
├── data/
│   ├── sensor_history.json        # 센서 데이터 (자동 누적)
│   ├── gdd_data.json              # 적산온도 (자동 계산)
│   └── phenology.json             # 생육 단계 기록 (자동/수동)
│
├── app.py                         # Streamlit 앱
├── fruit_growth.json              # 과실 성장 (수동 입력)
├── requirements.txt
└── README.md
```

## 🚀 설치 방법 (15분)

### 1단계: GitHub 저장소 생성 (3분)

1. GitHub에서 새 저장소 생성
2. 다운로드한 파일들 업로드

```bash
# 로컬에서 실행
git init
git add .
git commit -m "🥝 Initial commit"
git remote add origin https://github.com/당신아이디/kiwi-farm-ai.git
git branch -M main
git push -u origin main
```

### 2단계: GitHub Secrets 설정 (2분)

**Settings → Secrets and variables → Actions → New repository secret**

| Name | Value |
|------|-------|
| `ECOWITT_APP_KEY` | `A173F6BFBBBD80ABB1F3E85E63C694E3` |
| `ECOWITT_API_KEY` | `963717d1-764c-47f8-aecf-ffddebddba03` |
| `ECOWITT_MAC` | `30:83:98:A7:26:4F` |

### 3단계: GitHub Actions 활성화 (1분)

1. **Actions** 탭 클릭
2. "I understand my workflows" 클릭
3. 완료!

### 4단계: 테스트 (2분)

**Actions → Daily Data Collection → Run workflow**

1-2분 후 `data/sensor_history.json` 파일 확인

### 5단계: Streamlit Cloud 배포 (5분)

1. https://share.streamlit.io/
2. GitHub 연결
3. Repository 선택
4. `app.py` 선택
5. Deploy!

## 📊 데이터 흐름

```
매일 00:00 (자동)
    ↓
GitHub Actions 실행
    ↓
ECOWITT API → 어제 일별 데이터
    ↓
sensor_history.json 저장 (누적)
    ↓
적산온도 계산 → gdd_data.json
    ↓
생육 단계 자동 감지 → phenology.json
    ↓
Streamlit 앱 → 단계별 UI 자동 전환
```

## 🎯 사용 방법

### 자동으로 진행
- ✅ 센서 데이터 수집 (매일 자정)
- ✅ 적산온도 계산 (매일 자정)
- ✅ 생육 단계 감지 (자동)
- ✅ UI 자동 전환 (날짜 기반)

### 사용자가 할 일
- 📝 생육 이벤트 기록 (선택)
- 📏 과실 크기 측정 (6-10월, 주 1회)

## 📱 UI 구조

### 🏠 홈 탭
```
┌─────────────────────────────────────┐
│ 현재 생육 단계: 🌸 개화기/착과기     │
├─────────────────────────────────────┤
│ 📊 핵심 지표                         │
│  • 누적 GDD: 782°C·일               │
│  • 평균 온도: 18.5°C                │
│  • 평균 수분: 43%                   │
├─────────────────────────────────────┤
│ 💡 이번 단계 관리 포인트             │
│  • 최적 인공수분: 오전 9-11시        │
│  • 야간 온도 15°C 이상 유지          │
└─────────────────────────────────────┘
```

### 📡 센서 탭
- 최신 센서 데이터
- 최근 30일 추이 그래프

### 🌡️ 적산온도 탭
- 누적 GDD 현황
- 생육 이정표 (발아 200, 개화 750)
- GDD 추이 그래프

### 📝 생육 기록 탭
- 생육 이벤트 기록 (수동/자동)
- 올해 생육 타임라인

### 🤖 AI 예측 탭
- **1~3월**: 발아/개화 예측
- **4~5월**: 착과율 예측
- **6~10월**: 과실 성장 예측
- **11~12월**: 연간 리포트

## 🎓 생육 단계 자동 감지 로직

```python
if 1~3월 and GDD < 200:
    → 🌱 휴면기/발아기
elif 1~3월 and 200 ≤ GDD < 750:
    → 🌿 발아 후 성장기
elif 4~5월 or GDD ≥ 750:
    → 🌸 개화기/착과기
elif 6~10월:
    → 🥝 과실 비대기
else:
    → 📦 수확 후 관리
```

## 📈 AI 예측 예시

### 발아 예측 (1~3월)
```
현재 GDD: 150°C·일
일평균 증가: 5°C·일
발아 예상: 3월 20일 (약 10일 후)
```

### 착과율 예측 (4~5월)
```
평균 온도: 18.5°C (적정)
평균 습도: 65% (적정)
예상 착과율: 82% (우수)
```

### 과실 성장 예측 (6~10월)
```
예상 횡경: 72mm
예상 무게: 165g
품질 등급: 특A급
```

## 🔧 문제 해결

### GitHub Actions 미실행
1. Actions 탭 → 워크플로우 활성화 확인
2. Secrets 3개 정확히 입력했는지 확인
3. 수동 실행: Run workflow 클릭

### 데이터 미수집
1. Actions 탭 → 실행 로그 확인
2. ECOWITT API 키 확인
3. 센서 작동 확인 (ECOWITT 웹사이트)

### 앱 데이터 미표시
1. GitHub 저장소 `data/` 폴더에 JSON 파일 있는지 확인
2. Streamlit 앱 재배포

## 📅 연간 사용 시나리오

### 2월
- 시스템 설치 및 데이터 수집 시작
- 적산온도 누적 모니터링
- 발아 예측 확인

### 3월
- 발아 시작 자동 감지
- 저온 관리

### 4월
- 개화 시작 자동 감지
- 착과율 예측 확인
- 인공수분 시기 참고

### 5월
- 착과 확인 및 기록
- 적과 시기 결정

### 6~10월
- 주 1회 과실 측정 입력
- AI 모델 학습 및 예측
- 수확 시기 결정

### 11~12월
- 연간 데이터 분석
- 내년 계획 수립

## 💡 핵심 장점

1. **완전 자동**: 사용자 개입 최소화
2. **연중 사용**: 1년 내내 의미 있는 정보
3. **단계별 전환**: 날짜에 따라 UI 자동 변경
4. **학습 개선**: 매년 정확도 향상
5. **무료**: GitHub Actions 무료

## 📞 지원

GitHub Issues에 질문을 남겨주세요.

---

**Made with ❤️ for 키위 농장**

현재 버전: v2.0 (통합 생육 단계 시스템)
